{% extends 'base.html' %}
{% block subtitle %} {{request.session['scalar_or_3d'].title()}} Query Wizard {% endblock %}
{% block content %}
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="{{ static('primo/js/tablesorter-master/jquery.tablesorter.min.js') }}"></script>
<link rel="stylesheet" type="text/css" href="{{ static('primo/blue/style.css') }}" />
<p>Click on column headers to sort results by column. Columns can be deleted or reordered in your spreadsheet after download.</p>

<script type="text/javascript" >
$(document).ready(function()
    {
        $("#resultsTable").tablesorter();
    }
);
</script>


<table id="resultsTable" class="tablesorter">
<thead>
<tr>
    <th>Specimen ID</th>
    <th>Hypocode</th>
    <th>Collection Acronym</th>
    <th>Catalog No.</th>
    <th>Taxon name</th>
    <th>Sex</th>
    <th>Fossil or Extant</th>
    <th>Captive or Wild</th>
    <th>Session Comments</th>
    <th>Specimen Comments</th>
    {% for var_id in variable_labels %}
        <th>{{var_id[0]}}</th>
    {% endfor %}
</tr>
</thead>
<tbody>
{{total, final_sql}}

{% for row in query_results %}
<tr>
    <td>{{row['specimen_id']}}</td>
    <td>{{row['hypocode']}}</td>
    <td>{{row['collection_acronym']}}</td>
    <td>{{row['catalog_number']}}</td>
    <td>{{row['taxon_name']}}</td>
    <td>{{row['sex_type']}}</td>
    <td>{{row['fossil_or_extant']}}</td>
    <td>{{row['captive_or_wild']}}</td>
    <td>{{row['session_comments']}}</td>
    <td>{{row['specimen_comments']}}</td>
    {# {% for variable in variable_labels: %}
        <td>{{variable}}</td>
    {% endfor %} #}
    {% for label in variable_labels %}
        <!-- <br />{{label}} {{row['variable_label']}} {{row['scalar_value']}} {{row['hypocode']}} -->
        {% if label in row %}         <!-- the last element in the tuple is the dictionary of {variable id : variable label} -->
            <td>{{ row['label'] }}</td> <!-- so print value at that location -->
        {% else %}
            <td></td>
        {% endif %}
    {% endfor %}
</tr>
{% endfor %}

</tbody>
</table>

<!-- {% for row in request.session['results'] %}
<tr>
    {% for column in row %}
    <td>Smith</td>
    <td>John</td>
    <td>jsmith@gmail.com</td>
    <td>$50.00</td>
    <td>http://www.jsmith.com</td>
    {% endfor %}
</tr>
{% endfor %}

{{ request.session['query'] }}
<!-- <tr>
    <td>Smith</td>
    <td>John</td>
    <td>jsmith@gmail.com</td>
    <td>$50.00</td>
    <td>http://www.jsmith.com</td>
</tr>
<tr>
    <td>Bach</td>
    <td>Frank</td>
    <td>fbach@yahoo.com</td>
    <td>$50.00</td>
    <td>http://www.frank.com</td>
</tr>
<tr>
    <td>Doe</td>
    <td>Jason</td>
    <td>jdoe@hotmail.com</td>
    <td>$100.00</td>
    <td>http://www.jdoe.com</td>
</tr>
<tr>
    <td>Conway</td>
    <td>Tim</td>
    <td>tconway@earthlink.net</td>
    <td>$50.00</td>
    <td>http://www.timconway.com</td>
</tr>
</tbody>
</table>
{{ request.session['final_result'] }}
<div id="query-wizard-filter-tables">
    <table width="30%" border="0" cellspacing="0" id="resultsTable" class="tablesorter">
        <tr><th>Table</th><th>Attributes Selected</th></tr>
{% for table in tables %}

        <tr>
            <td><a href="{{ url('parameter_selection', table['table_name']) }}">{{ table['display_name']|safe() }} &raquo;</a></td>
            {% if selected[table['table_name']] %}
            <td><img alt="selected" align="middle" src="{{ static('primo/images/tick.gif') }}" /></td>
            {% else %}
            <td><img alt="selected" align="middle" src="{{ static('primo/images/tick2_blank.gif') }}" /></td>
            {% endif %}
    {% endfor %}
    </table>
</div>
    <br />

    <a href="{{ url('query_start') }}">Reset Query </a>

    {% if finished %}
        &nbsp;&nbsp; :: &nbsp;&nbsp;
        <a href="{{ url('query'), isScalar, '', True }}">Preview format  &raquo;</a>
        &nbsp;&nbsp; :: &nbsp;&nbsp;
        {% if scalar_or_3d == "scalar" %}
            <a href="{{ url('query'), isScalar, '', False }}">See results  &raquo;</a>
        {% else %}
            <a href="{{ url('query'), isScalar, 'Morphologika', False }}">Download Morphologika file  &raquo;</a>
            &nbsp;&nbsp; :: &nbsp;&nbsp;
            <a href="{{ url('query'), isScalar, 'GRFND', False }}">Download GRFND file  &raquo;</a>
        {% endif %}

    {% endif %}
    <br />
</div>

--> {% endblock %}
